<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Functions to compute weighted tables or summaries, based on a vector of
frequency weights. These are reimplementations of various existing functions,
adapted to objects of class "declared" (see Details below)'><title>Compute weighted summaries for declared objects — w_mean • declared</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute weighted summaries for declared objects — w_mean"><meta property="og:description" content='Functions to compute weighted tables or summaries, based on a vector of
frequency weights. These are reimplementations of various existing functions,
adapted to objects of class "declared" (see Details below)'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">declared</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.19.1.0001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dusadrian/declared/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute weighted summaries for declared objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/dusadrian/declared/blob/HEAD/R/w_mean.R" class="external-link"><code>R/w_mean.R</code></a>, <a href="https://github.com/dusadrian/declared/blob/HEAD/R/w_median.R" class="external-link"><code>R/w_median.R</code></a>, <a href="https://github.com/dusadrian/declared/blob/HEAD/R/w_mode.R" class="external-link"><code>R/w_mode.R</code></a>, and 6 more</small>
      <div class="d-none name"><code>weighted.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions to compute weighted tables or summaries, based on a vector of
frequency weights. These are reimplementations of various existing functions,
adapted to objects of class <code>"declared"</code> (see Details below)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">w_mean</span><span class="op">(</span><span class="va">x</span>, wt <span class="op">=</span> <span class="cn">NULL</span>, trim <span class="op">=</span> <span class="fl">0</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">w_median</span><span class="op">(</span><span class="va">x</span>, wt <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">w_mode</span><span class="op">(</span><span class="va">x</span>, wt <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">w_quantile</span><span class="op">(</span><span class="va">x</span>, wt <span class="op">=</span> <span class="cn">NULL</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.25</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">w_sd</span><span class="op">(</span><span class="va">x</span>, wt <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">w_standardize</span><span class="op">(</span><span class="va">x</span>, wt <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">w_summary</span><span class="op">(</span><span class="va">x</span>, wt <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">w_table</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  wt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  valid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  observed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  margin <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">w_var</span><span class="op">(</span><span class="va">x</span>, wt <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A numeric vector for summaries, or declared / factor for frequency
tables</p></dd>


<dt>wt</dt>
<dd><p>A numeric vector of frequency weights</p></dd>


<dt>trim</dt>
<dd><p>A fraction (0 to 0.5) of observations to be trimmed from each end
of x before the mean is computed. Values of trim outside that range are
taken as the nearest endpoint.</p></dd>


<dt>na.rm</dt>
<dd><p>Logical, should the empty missing values be removed?</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>


<dt>probs</dt>
<dd><p>Numeric vector of probabilities with values in [0,1]</p></dd>


<dt>method</dt>
<dd><p>Character, specifying how the result is scaled, see 'Details'
below.</p></dd>


<dt>y</dt>
<dd><p>An optional variable, to create crosstabs; must have the same length
as x</p></dd>


<dt>values</dt>
<dd><p>Logical, print the values in the table rows</p></dd>


<dt>valid</dt>
<dd><p>Logical, print the percent distribution for non-missing values,
if any missing values are present</p></dd>


<dt>observed</dt>
<dd><p>Logical, print the observed categories only</p></dd>


<dt>margin</dt>
<dd><p>Numeric, indicating the margin to calculate crosstab
proportions: 0 from the total, 1 from row totals and 2 from column totals</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A vector of (weighted) values.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Weighted summaries</p>
<p>A frequency table is usually performed for a categorical variable, displaying
the frequencies of the respective categories. Note that general variables
containing text are not necessarily factors, despite having a small number of
characters.</p>
<p>A general table of frequencies, using the base function <code><a href="https://rdrr.io/r/base/table.html" class="external-link">table()</a></code>, ignores
the defined missing values (which are all stored as NAs). The
reimplementation of this function in <code>w_table()</code> takes care of this detail,
and presents frequencies for each separately defined missing values. Similar
reimplementations for the other functions have the same underlying objective.</p>
<p>It is also possible to perform a frequency table for numerical variables, if
the number of values is limited (an arbitrary and debatable upper limit of 15
is used). An example of such variable can be the number of children, where
each value can be interpreted as a class, containing a single value (for
instance 0 meaning the category of people with no children).</p>
<p>Objects of class <code>declared</code> are not pure categorical variables (R factors)
but they are nevertheless interpreted similarly to factors, to allow
producing frequency tables. Given the high similarity with package
<strong><code>haven</code></strong>, objects of class <code>haven_labelled_spss</code> are automatically
coerced to objects of class <code>declared</code> and treated accordingly.</p>
<p>The argument <code>values</code> makes sense only when the input is of family class
<code>declared</code>, otherwise for regular (base R) factors the values are
just a sequence of numbers.</p>
<p>The later introduced argument <code>observed</code> is useful in situations when a
variable has a very large number of potential values, and a smaller subset of
actually observed ones. As an example, the variable “Occupation” has
hundreds of possible values in the ISCO08 codelist, and not all of them might
be actually observed. When activated, this argument restricts the printed
frequency table to the subset of observed values only.</p>
<p>The argument <code>method</code> can be one of <code>"unbiased"</code> or <code>"ML"</code>.</p>
<p>When this is set to <code>"unbiased"</code>, the result is an unbiased estimate
using Bessel's correction. When this is set to <code>"ML"</code>, the result is the
maximum likelihood estimate for a Gaussian distribution.</p>
<p>The argument <code>wt</code> refers only to frequency weights. Users should be
aware of the differences between frequency weights, analytic weights,
probability weights, design weights, post-stratification weights etc. For
purposes of inferential testing, Thomas Lumley's package <strong><code>survey</code></strong>
should be employed.</p>
<p>If no frequency weights are provided, the result is identical to the
corresponding base functions.</p>
<p>The function <code>w_quantile()</code> extensively borrowed ideas from packages
<strong><code>stats</code></strong> and <strong><code>Hmisc</code></strong>, to ensure a constant interpolation that would
produce the same quantiles if no weights are provided or if all
weights are equal to 1.</p>
<p>Other arguments can be passed to the stats function <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code> via the
three dots <code>...</code> argument, and their extensive explanation is found in the
corresponding stats function's help page.</p>
<p>For all functions, the argument <code>na.rm</code> refers to the empty missing values
and its default is set to TRUE. The declared missing values are automatically
eliminated from the summary statistics, even if this argument is deactivated.</p>
<p>The function <code>w_mode()</code> returns the weighted mode of a variable. Unlike the
other functions where the prefix <code>w_</code> signals a weighted version of the
base function with the same name, this has nothing to do with the base
function <code><a href="https://rdrr.io/r/base/mode.html" class="external-link">mode()</a></code> which refers to the storage mode / type of an R object.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Adrian Dusa</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">215</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a pure categorical variable</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">215</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">w_table</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fre    rel   per   cpd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a  37  0.172  17.2  17.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  45  0.209  20.9  38.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c  43  0.200  20.0  58.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d  44  0.205  20.5  78.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e  46  0.214  21.4 100.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   215  1.000 100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate number of children</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">215</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">w_table</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fre    rel   per   cpd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0  36  0.167  16.7  16.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  41  0.191  19.1  35.8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  49  0.228  22.8  58.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  45  0.209  20.9  79.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  44  0.205  20.5 100.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   215  1.000 100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate a Likert type response scale from 1 to 7</span></span></span>
<span class="r-in"><span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">91</span><span class="op">)</span>, <span class="fl">215</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="declared.html">declared</a></span><span class="op">(</span><span class="va">values</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Good"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"Bad"</span> <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">w_table</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      fre    rel   per   cpd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -91  16  0.074   7.4   7.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Good  25  0.116  11.6  19.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2  25  0.116  11.6  30.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  32  0.149  14.9  45.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4  37  0.172  17.2  62.8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5  24  0.112  11.2  74.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6  21  0.098   9.8  83.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Bad  35  0.163  16.3 100.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      215  1.000 100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Defining missing values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="missing_values.html">missing_values</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">91</span></span></span>
<span class="r-in"><span><span class="fu">w_table</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      fre    rel   per   vld   cpd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ----------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Good  25  0.116  11.6  12.6  12.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2  25  0.116  11.6  12.6  25.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  32  0.149  14.9  16.1  41.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4  37  0.172  17.2  18.6  59.8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5  24  0.112  11.2  12.1  71.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6  21  0.098   9.8  10.6  82.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Bad  35  0.163  16.3  17.6 100.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -91  16  0.074   7.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ----------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      215  1.000 100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Defined missing values with labels</span></span></span>
<span class="r-in"><span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">91</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fl">215</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="declared.html">declared</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">values</span>,</span></span>
<span class="r-in"><span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Good"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"Bad"</span> <span class="op">=</span> <span class="fl">7</span>, <span class="st">"Don't know"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">91</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    na_values <span class="op">=</span> <span class="op">-</span><span class="fl">91</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">w_table</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            fre    rel   per   vld   cpd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ----------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Good  20  0.093   9.3  12.0  12.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2  33  0.153  15.3  19.9  31.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          3  27  0.126  12.6  16.3  48.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          4  27  0.126  12.6  16.3  64.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          5  22  0.102  10.2  13.3  77.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          6  22  0.102  10.2  13.3  91.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Bad  15  0.070   7.0   9.0 100.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      -----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Don't know  24  0.112  11.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         NA  25  0.116  11.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ----------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            215  1.000 100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Including the values in the table of frequencies</span></span></span>
<span class="r-in"><span><span class="fu">w_table</span><span class="op">(</span><span class="va">x</span>, values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                fre    rel   per   vld   cpd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                ----------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Good   1  20  0.093   9.3  12.0  12.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2   2  33  0.153  15.3  19.9  31.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          3   3  27  0.126  12.6  16.3  48.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          4   4  27  0.126  12.6  16.3  64.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          5   5  22  0.102  10.2  13.3  77.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          6   6  22  0.102  10.2  13.3  91.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Bad   7  15  0.070   7.0   9.0 100.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Don't know -91  24  0.112  11.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             NA  25  0.116  11.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                ----------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                215  1.000 100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># An example involving multiple variables</span></span></span>
<span class="r-in"><span><span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Area <span class="op">=</span> <span class="fu"><a href="declared.html">declared</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">215</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">0.55</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Rural <span class="op">=</span> <span class="fl">1</span>, Urban <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    Gender <span class="op">=</span> <span class="fu"><a href="declared.html">declared</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">215</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.55</span>, <span class="fl">0.45</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Males <span class="op">=</span> <span class="fl">1</span>, Females <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    Age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">18</span><span class="op">:</span><span class="fl">90</span>, <span class="fl">215</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Children <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">215</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">w_table</span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">Gender</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         fre    rel   per   cpd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Males 119  0.553  55.3  55.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Females  96  0.447  44.7 100.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         215  1.000 100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">w_sd</span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">Age</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20.19372</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Weighting: observed proportions</span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">proportions</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">DF</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Gender</span>, <span class="va">Area</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Theoretical proportions: 53% Rural, and 50% Females</span></span></span>
<span class="r-in"><span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.53</span>, <span class="fl">0.47</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.498</span>, <span class="fl">0.502</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">op</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">DF</span><span class="op">$</span><span class="va">fweight</span> <span class="op">&lt;-</span> <span class="va">tp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="va">DF</span><span class="op">$</span><span class="va">Area</span> <span class="op">+</span> <span class="va">DF</span><span class="op">$</span><span class="va">Gender</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">DF</span>, <span class="fu">w_table</span><span class="op">(</span><span class="va">Gender</span>, wt <span class="op">=</span> <span class="va">fweight</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         fre    rel   per   cpd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Males 107  0.498  49.8  49.8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Females 108  0.502  50.2 100.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         215  1.000 100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">DF</span>, <span class="fu">w_mean</span><span class="op">(</span><span class="va">Age</span>, wt <span class="op">=</span> <span class="va">fweight</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 55.12584</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">DF</span>, <span class="fu">w_quantile</span><span class="op">(</span><span class="va">Age</span>, wt <span class="op">=</span> <span class="va">fweight</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0%   25%  50%  75% 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   18   38   55   71   90 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Adrian Dusa.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

