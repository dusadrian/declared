<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The labelled vectors are mainly used to analyse social science data,
and the missing values declaration is an important step in the analysis."><title>Labelled vectors with declared missing values — as.declared • declared</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Labelled vectors with declared missing values — as.declared"><meta property="og:description" content="The labelled vectors are mainly used to analyse social science data,
and the missing values declaration is an important step in the analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">declared</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.23</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dusadrian/declared/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Labelled vectors with declared missing values</h1>
      <small class="dont-index">Source: <a href="https://github.com/dusadrian/declared/blob/HEAD/R/as.declared.R" class="external-link"><code>R/as.declared.R</code></a>, <a href="https://github.com/dusadrian/declared/blob/HEAD/R/declared.R" class="external-link"><code>R/declared.R</code></a>, <a href="https://github.com/dusadrian/declared/blob/HEAD/R/is.declared.R" class="external-link"><code>R/is.declared.R</code></a></small>
      <div class="d-none name"><code>declared.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The labelled vectors are mainly used to analyse social science data,
and the missing values declaration is an important step in the analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">as.declared</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">declared</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na_values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  measurement <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  llevels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is.declared</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">anyNAdeclared</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A numeric vector to label, or a declared labelled vector
(for <code>undeclare</code>)</p></dd>


<dt>...</dt>
<dd><p>Other arguments used by various other methods</p></dd>


<dt>labels</dt>
<dd><p>A named vector or <code>NULL</code>. The vector should be the same type
as <code>x</code>. Unlike factors, labels don't need to be exhaustive: only a fraction
of the values might be labelled</p></dd>


<dt>na_values</dt>
<dd><p>A vector of values that should also be considered as missing</p></dd>


<dt>na_range</dt>
<dd><p>A numeric vector of length two giving the (inclusive) extents
of the range. Use <code>-Inf</code> and <code>Inf</code> if you want the range to be
open ended</p></dd>


<dt>label</dt>
<dd><p>A short, human-readable description of the vector</p></dd>


<dt>measurement</dt>
<dd><p>Optional, user specified measurement level</p></dd>


<dt>llevels</dt>
<dd><p>Logical, when <code>x</code> is a factor only use those levels that have
labels</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>declared()</code> and <code>as.declared()</code> return labelled vector of class
"declared". When applied to a data frame, <code>as.declared()</code> will return a
corresponding data frame with declared variables. <code>is.declared()</code> and
<code>anyNAdeclared</code> return a logical value.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>declared</code> objects are very similar to the <code>haven_labelled_spss</code> objects
from package <b>haven</b>. It has exactly the same arguments, but it features
a fundamental difference in the treatment of (declared) missing values.</p>
<p>In package <b>haven</b>, existing values are treated as if they were missing.
By contrast, in package <b>declared</b> the NA values are treated as if they
were existing values.</p>
<p>This difference is fundamental and points to an inconsistency in package
<b>haven</b>: while existing values can be identified as missing using the
function <code><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na()</a></code>, they are in fact present in the vector and other
packages (most importantly the base ones) do not know these values should be
treated as missing.</p>
<p>Consequently, the existing values are interpreted as missing only by package
<b>haven</b>. Statistical procedures will use those values as if they were
valid values.</p>
<p>Package <b>declared</b> approaches the problem in exactly the opposite way:
instead of treating existing values as missing, it treats (certain) NA values
as existing. It does that by storing an attribute containing the indices of
those NA values which are to be treated as declared missing values, and it
refreshes this attribute each time the declared object is changed.</p>
<p>This is a trade off and has important implications when subsetting datasets:
all declared variables get this attribute refreshed, which consumes some time
depending on the number of variables in the data.</p>
<p>The generic function <code>as.declared()</code> attempts to coerce only the compatible
types of objects, namely <code>haven_labelled</code> and <code>factor</code>s. Dedicated class
methods can be written for any other type of object, and users are free to
write their own. To end of with a declared object, additional metadata is
needed such as value labels, which values should be treated as missing etc.</p>
<p>The measurement level is optional and, for the moment, purely aesthetic. It
might however be useful to (automatically) determine if a declared object is
suitable for a certain statistical analysis, for instance regression requires
quantitative variables, while some declared objects are certainly categorical
despite using numbers to denote categories.</p>
<p>It distinguishes between <code>"categorial"</code> and <code>"quantitative"</code> types of
variables, and additionally recognizes <code>"nominal"</code> and <code>"ordinal"</code> as
categorical, and similarly recognizes <code>"interval"</code>, <code>"ratio"</code>,
<code>"discrete"</code> and <code>"continuous"</code> as quantitative.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">declared</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Good <span class="op">=</span> <span class="fl">1</span>, Bad <span class="op">=</span> <span class="fl">5</span>, DK <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    na_values <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;declared&lt;integer&gt;[6]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]      1      2      3      4      5 NA(-1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  Good</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5   Bad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -1    DK</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE FALSE FALSE FALSE  TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE FALSE FALSE FALSE  TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Values are actually placeholder for categories,</span></span></span>
<span class="r-in"><span><span class="co"># so labels work as if they were factors:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">==</span> <span class="st">"DK"</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE FALSE FALSE FALSE  TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># when newly added values are already declared as missing,</span></span></span>
<span class="r-in"><span><span class="co"># they are automatically coerced</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;declared&lt;integer&gt;[8]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]      1      2      3      4      5 NA(-1)      2 NA(-1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -1    DK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  Good</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5   Bad</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># switch NAs with their original values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="drop_undeclare.html">undeclare</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;declared&lt;integer&gt;[6]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1  2  3  4  5 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  Good</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5   Bad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -1    DK</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Good" "2"    "3"    "4"    "Bad"  NA    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Returning values instead of categories</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span>, values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1" "2" "3" "4" "5" NA </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Adrian Dusa.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

